import matplotlib.pyplot as plt
import numpy as np
position=np.array([0, 0.1, 0.2, 0.30000000000000004, 0.4, 0.5, 0.6000000000000001, 0.7000000000000001, 0.8, 0.9, 1, 1.1, 1.2000000000000002, 1.3, 1.4000000000000001, 1.5, 1.6, 1.7000000000000002, 1.8, 1.9000000000000001, 2, 2.1, 2.2, 2.3000000000000003, 2.4000000000000004, 2.5, 2.6, 2.7, 2.8000000000000003, 2.9000000000000004, 3, 3.1, 3.2, 3.3000000000000003, 3.4000000000000004, 3.5, 3.6, 3.7, 3.8000000000000003, 3.9000000000000004, 4, 4.1000000000000005, 4.2, 4.3, 4.4, 4.5, 4.6000000000000005, 4.7, 4.800000000000001, 4.9, 5, 5.1000000000000005, 5.2, 5.300000000000001, 5.4, 5.5, 5.6000000000000005, 5.7, 5.800000000000001, 5.9, 6, 6.1000000000000005, 6.2, 6.300000000000001, 6.4, 6.5, 6.6000000000000005, 6.7, 6.800000000000001, 6.9, 7, 7.1000000000000005, 7.2, 7.300000000000001, 7.4, 7.5, 7.6000000000000005, 7.7, 7.800000000000001, 7.9, 8, 8.1, 8.200000000000001, 8.3, 8.4, 8.5, 8.6, 8.700000000000001, 8.8, 8.9, 9, 9.1, 9.200000000000001, 9.3, 9.4, 9.5, 9.600000000000001, 9.700000000000001, 9.8, 9.9, 10, 10.100000000000001, 10.200000000000001, 10.3, 10.4, 10.5, 10.600000000000001, 10.700000000000001, 10.8, 10.9, 11, 11.100000000000001, 11.200000000000001, 11.3, 11.4, 11.5, 11.600000000000001, 11.700000000000001, 11.8, 11.9, 12, 12.100000000000001, 12.200000000000001, 12.3, 12.4, 12.5, 12.600000000000001, 12.700000000000001, 12.8, 12.9, 13, 13.100000000000001, 13.200000000000001, 13.3, 13.4, 13.5, 13.600000000000001, 13.700000000000001, 13.8, 13.9, 14, 14.100000000000001, 14.200000000000001, 14.3, 14.4, 14.5, 14.600000000000001, 14.700000000000001, 14.8, 14.9, 15, 15.100000000000001, 15.200000000000001, 15.3, 15.4, 15.5, 15.600000000000001, 15.700000000000001, 15.8, 15.9, 16, 16.1, 16.2, 16.3, 16.400000000000002, 16.5, 16.6, 16.7, 16.8, 16.900000000000002, 17, 17.1, 17.2, 17.3, 17.400000000000002, 17.5, 17.6, 17.7, 17.8, 17.900000000000002, 18, 18.1, 18.2, 18.3, 18.400000000000002, 18.5, 18.6, 18.7, 18.8, 18.900000000000002, 19, 19.1, 19.200000000000003, 19.3, 19.400000000000002, 19.5, 19.6, 19.700000000000003, 19.8, 19.900000000000002, 20, 20.1, 20.200000000000003, 20.3, 20.400000000000002, 20.5, 20.6, 20.700000000000003, 20.8, 20.900000000000002, 21, 21.1, 21.200000000000003, 21.3, 21.400000000000002, 21.5, 21.6, 21.700000000000003, 21.8, 21.900000000000002, 22, 22.1, 22.200000000000003, 22.3, 22.400000000000002, 22.5, 22.6, 22.700000000000003, 22.8, 22.900000000000002, 23, 23.1, 23.200000000000003, 23.3, 23.400000000000002, 23.5, 23.6, 23.700000000000003, 23.8, 23.900000000000002, 24, 24.1, 24.200000000000003, 24.3, 24.400000000000002, 24.5, 24.6, 24.700000000000003, 24.8, 24.900000000000002, 25, 25.1, 25.200000000000003, 25.3, 25.400000000000002, 25.5, 25.6, 25.700000000000003, 25.8, 25.900000000000002, 26, 26.1, 26.200000000000003, 26.3, 26.400000000000002, 26.5, 26.6, 26.700000000000003, 26.8, 26.900000000000002, 27, 27.1, 27.200000000000003, 27.3, 27.400000000000002, 27.5, 27.6, 27.700000000000003, 27.8, 27.900000000000002, 28, 28.1, 28.200000000000003, 28.3, 28.400000000000002, 28.5, 28.6, 28.700000000000003, 28.8, 28.900000000000002, 29, 29.1, 29.200000000000003, 29.3, 29.400000000000002, 29.5, 29.6, 29.700000000000003, 29.8, 29.900000000000002, 30, 30.1, 30.200000000000003, 30.3, 30.400000000000002, 30.5, 30.6, 30.700000000000003, 30.8, 30.900000000000002, 31, 31.1, 31.200000000000003, 31.3, 31.400000000000002, 31.5, 31.6, 31.700000000000003, 31.8, 31.900000000000002, 32, 32.1, 32.2, 32.300000000000004, 32.4, 32.5, 32.6, 32.7, 32.800000000000004, 32.9, 33, 33.1, 33.2, 33.300000000000004, 33.4, 33.5, 33.6, 33.7, 33.800000000000004, 33.9, 34, 34.1, 34.2, 34.300000000000004, 34.4, 34.5, 34.6, 34.7, 34.800000000000004, 34.9, 35, 35.1, 35.2, 35.300000000000004, 35.4, 35.5, 35.6, 35.7, 35.800000000000004, 35.9, 36, 36.1, 36.2, 36.300000000000004, 36.4, 36.5, 36.6, 36.7, 36.800000000000004, 36.9, 37, 37.1, 37.2, 37.300000000000004, 37.4, 37.5, 37.6, 37.7, 37.800000000000004, 37.9, 38, 38.1, 38.2, 38.300000000000004, 38.400000000000006, 38.5, 38.6, 38.7, 38.800000000000004, 38.900000000000006, 39, 39.1, 39.2, 39.300000000000004, 39.400000000000006, 39.5, 39.6, 39.7, 39.800000000000004, 39.900000000000006, 40, 40.1, 40.2, 40.300000000000004, 40.400000000000006, 40.5, 40.6, 40.7, 40.800000000000004, 40.900000000000006, 41, 41.1, 41.2, 41.300000000000004, 41.400000000000006, 41.5, 41.6, 41.7, 41.800000000000004, 41.900000000000006, 42, 42.1, 42.2, 42.300000000000004, 42.400000000000006, 42.5, 42.6, 42.7, 42.800000000000004, 42.900000000000006, 43, 43.1, 43.2, 43.300000000000004, 43.400000000000006, 43.5, 43.6, 43.7, 43.800000000000004, 43.900000000000006, 44, 44.1, 44.2, 44.300000000000004, 44.400000000000006, 44.5, 44.6, 44.7, 44.800000000000004, 44.900000000000006, 45, 45.1, 45.2, 45.300000000000004, 45.400000000000006, 45.5, 45.6, 45.7, 45.800000000000004, 45.900000000000006, 46, 46.1, 46.2, 46.300000000000004, 46.400000000000006, 46.5, 46.6, 46.7, 46.800000000000004, 46.900000000000006, 47, 47.1, 47.2, 47.300000000000004, 47.400000000000006, 47.5, 47.6, 47.7, 47.800000000000004, 47.900000000000006, 48, 48.1, 48.2, 48.300000000000004, 48.400000000000006, 48.5, 48.6, 48.7, 48.800000000000004, 48.900000000000006, 49, 49.1, 49.2, 49.300000000000004, 49.400000000000006, 49.5, 49.6, 49.7, 49.800000000000004, 49.900000000000006, 50, 50.1, 50.2, 50.300000000000004, 50.400000000000006, 50.5, 50.6, 50.7, 50.800000000000004, 50.900000000000006, 51, 51.1, 51.2, 51.300000000000004, 51.400000000000006, 51.5, 51.6, 51.7, 51.800000000000004, 51.900000000000006, 52, 52.1, 52.2, 52.300000000000004, 52.400000000000006, 52.5, 52.6, 52.7, 52.800000000000004, 52.900000000000006, 53, 53.1, 53.2, 53.300000000000004, 53.400000000000006, 53.5, 53.6, 53.7, 53.800000000000004, 53.900000000000006, 54, 54.1, 54.2, 54.300000000000004, 54.400000000000006, 54.5, 54.6, 54.7, 54.800000000000004, 54.900000000000006, 55, 55.1, 55.2, 55.300000000000004, 55.400000000000006, 55.5, 55.6, 55.7, 55.800000000000004, 55.900000000000006, 56, 56.1, 56.2, 56.300000000000004, 56.400000000000006, 56.5, 56.6, 56.7, 56.800000000000004, 56.900000000000006, 57, 57.1, 57.2, 57.300000000000004, 57.400000000000006, 57.5, 57.6, 57.7, 57.800000000000004, 57.900000000000006, 58, 58.1, 58.2, 58.300000000000004, 58.400000000000006, 58.5, 58.6, 58.7, 58.800000000000004, 58.900000000000006, 59, 59.1, 59.2, 59.300000000000004, 59.400000000000006, 59.5, 59.6, 59.7, 59.800000000000004, 59.900000000000006, 60, 60.1, 60.2, 60.300000000000004, 60.400000000000006, 60.5, 60.6, 60.7, 60.800000000000004, 60.900000000000006, 61, 61.1, 61.2, 61.300000000000004, 61.400000000000006, 61.5, 61.6, 61.7, 61.800000000000004, 61.900000000000006, 62, 62.1, 62.2, 62.300000000000004, 62.400000000000006, 62.5, 62.6, 62.7, 62.800000000000004, 62.900000000000006, 63, 63.1, 63.2, 63.300000000000004, 63.400000000000006, 63.5, 63.6, 63.7, 63.800000000000004, 63.900000000000006, 64, 64.10000000000001, 64.2, 64.3, 64.4, 64.5, 64.60000000000001, 64.7, 64.8, 64.9, 65, 65.10000000000001, 65.2, 65.3, 65.4, 65.5, 65.60000000000001, 65.7, 65.8, 65.9, 66, 66.10000000000001, 66.2, 66.3, 66.4, 66.5, 66.60000000000001, 66.7, 66.8, 66.9, 67, 67.10000000000001, 67.2, 67.3, 67.4, 67.5, 67.60000000000001, 67.7, 67.8, 67.9, 68, 68.10000000000001, 68.2, 68.3, 68.4, 68.5, 68.60000000000001, 68.7, 68.8, 68.9, 69, 69.10000000000001, 69.2, 69.3, 69.4, 69.5, 69.60000000000001, 69.7, 69.8, 69.9, 70, 70.10000000000001, 70.2, 70.3, 70.4, 70.5, 70.60000000000001, 70.7, 70.8, 70.9, 71, 71.10000000000001, 71.2, 71.3, 71.4, 71.5, 71.60000000000001, 71.7, 71.8, 71.9, 72, 72.10000000000001, 72.2, 72.3, 72.4, 72.5, 72.60000000000001, 72.7, 72.8, 72.9, 73, 73.10000000000001, 73.2, 73.3, 73.4, 73.5, 73.60000000000001, 73.7, 73.8, 73.9, 74, 74.10000000000001, 74.2, 74.3, 74.4, 74.5, 74.60000000000001, 74.7, 74.8, 74.9, 75, 75.10000000000001, 75.2, 75.3, 75.4, 75.5, 75.60000000000001, 75.7, 75.8, 75.9, 76, 76.10000000000001, 76.2, 76.3, 76.4, 76.5, 76.60000000000001, 76.7, 76.80000000000001, 76.9, 77, 77.10000000000001, 77.2, 77.30000000000001, 77.4, 77.5, 77.60000000000001, 77.7, 77.80000000000001, 77.9, 78, 78.10000000000001, 78.2, 78.30000000000001, 78.4, 78.5, 78.60000000000001, 78.7, 78.80000000000001, 78.9, 79, 79.10000000000001, 79.2, 79.30000000000001, 79.4, 79.5, 79.60000000000001, 79.7, 79.80000000000001, 79.9])
values=np.array([1.4855710491367862, 1.4733665338645419, 1.4840305444887119, 1.4832403718459495, 1.4853519256308103, 1.4810690571049139, 1.4711420982735726, 1.4819322709163347, 1.4770849933598937, 1.476354581673307, 1.4817197875166002, 1.4741235059760955, 1.4729747675962817, 1.4702390438247013, 1.4665537848605579, 1.4742430278884462, 1.4704515272244358, 1.460863213811421, 1.462875166002656, 1.4651261620185922, 1.4778087649402392, 1.4805378486055778, 1.482277556440903, 1.4852722443559094, 1.47, 1.474495351925631, 1.481527224435591, 1.4757171314741035, 1.4805843293492695, 1.4779548472775565, 1.4888446215139444, 1.480292164674635, 1.48429614873838, 1.480066401062417, 1.4761088977423638, 1.4802058432934926, 1.4836985391766269, 1.4875962815405046, 1.4765670650730411, 1.4801195219123506, 1.4806042496679948, 1.4834395750332006, 1.4827025232403717, 1.4835790172642764, 1.474428950863214, 1.4778751660026561, 1.4764674634794157, 1.4690770252324037, 1.463877822045153, 1.458585657370518, 1.4631938911022575, 1.4585059760956176, 1.4665272244355911, 1.4686387782204517, 1.4588977423638778, 1.4635391766268262, 1.4658764940239046, 1.4618260292164673, 1.4662749003984064, 1.4631142098273573, 1.4643957503320053, 1.4595351925630808, 1.453134130146082, 1.4555112881806107, 1.4569588313413013, 1.4595750332005313, 1.4652257636122177, 1.4681474103585657, 1.4698207171314739, 1.4796347941567065, 1.4695086321381141, 1.4732536520584327, 1.4741899070385125, 1.4723505976095617, 1.476281540504648, 1.4818061088977423, 1.477609561752988, 1.4762549800796814, 1.4687782204515274, 1.4641235059760955, 1.471440903054449, 1.4817729083665339, 1.4857038512616205, 1.4837715803452856, 1.4800996015936254, 1.4801261620185922, 1.486308100929615, 1.473758300132802, 1.4785989375830013, 1.4766733067729083, 1.4820849933598939, 1.4741235059760955, 1.4704847277556443, 1.4698339973439576, 1.480949535192563, 1.4898074369189909, 1.4872642762284196, 1.4716334661354582, 1.4775099601593626, 1.4805843293492695, 1.482476759628154, 1.4771845949535192, 1.4686852589641435, 1.4769588313413016, 1.4742695883134131, 1.481261620185923, 1.4766201859229748, 1.4812881806108897, 1.478413014608234, 1.4759030544488712, 1.4792430278884465, 1.4832403718459497, 1.4741168658698538, 1.4721381142098275, 1.4808167330677289, 1.4795418326693228, 1.4733930942895086, 1.4800398406374502, 1.4765936254980079, 1.4697476759628156, 1.478472775564409, 1.4707901726427621, 1.4739309428950864, 1.4746347941567064, 1.4658034528552455, 1.465863213811421, 1.4704913678618858, 1.4677622841965472, 1.4724369189907038, 1.4742563081009294, 1.4710292164674637, 1.4678552456839309, 1.4699468791500665, 1.477324037184595, 1.4768393094289511, 1.482436918990704, 1.474800796812749, 1.4721049136786188, 1.4730212483399736, 1.482589641434263, 1.4756772908366533, 1.467463479415671, 1.479409030544489, 1.4796547144754315, 1.474448871181939, 1.474754316069057, 1.4796613545816732, 1.4800996015936254, 1.4795219123505976, 1.475597609561753, 1.476148738379814, 1.4745683930942894, 1.4710026560424967, 1.4761221779548472, 1.4808499335989374, 1.47535192563081, 1.4745285524568394, 1.4782934926958828, 1.4745152722443557, 1.4768658698539179, 1.4762682602921648, 1.4778950863213813, 1.469734395750332, 1.4815338645418328, 1.4769123505976098, 1.4782337317397078, 1.471022576361222, 1.4799003984063743, 1.4802257636122178, 1.4781540504648074, 1.467828685258964, 1.4713413014608234, 1.4631540504648075, 1.473094289508632, 1.4793758300132804, 1.46996015936255, 1.4807436918990704, 1.467589641434263, 1.4723107569721117, 1.4712948207171312, 1.4680278884462152, 1.4841699867197875, 1.4687516600265602, 1.474867197875166, 1.4733001328021251, 1.4745949535192564, 1.462257636122178, 1.4681341301460824, 1.4751460823373173, 1.4741035856573705, 1.475358565737052, 1.4799402390438248, 1.46097609561753, 1.4675962815405046, 1.468559096945551, 1.471972111553785, 1.4744355909694558, 1.4709163346613547, 1.4763545816733068, 1.486195219123506, 1.4794023904382472, 1.475265604249668, 1.4841035856573705, 1.4675298804780876, 1.474780876494024, 1.475996015936255, 1.4759163346613544, 1.4772841965471448, 1.470909694555113, 1.4744223107569723, 1.4696347941567065, 1.4840770252324038, 1.464780876494024, 1.465617529880478, 1.4716268260292165, 1.4739575033200532, 1.470026560424967, 1.4786653386454183, 1.4715537848605578, 1.482436918990704, 1.4735590969455512, 1.4729814077025234, 1.4769322709163348, 1.469820717131474, 1.4766666666666666, 1.4737450199203186, 1.471726427622842, 1.4673904382470122, 1.4727954847277556, 1.4799601593625498, 1.4759827357237716, 1.4771049136786187, 1.4766401062416998, 1.471022576361222, 1.4762549800796811, 1.4760956175298805, 1.4675431606905711, 1.4679083665338646, 1.4745019920318727, 1.4678552456839307, 1.4731075697211156, 1.4802855245683928, 1.4751859229747675, 1.4694820717131474, 1.4665272244355911, 1.476414342629482, 1.4721580345285523, 1.477410358565737, 1.4725498007968127, 1.4717065073041167, 1.4749667994687916, 1.4777423638778222, 1.4764276228419655, 1.4801593625498006, 1.4703652058432934, 1.4689907038512615, 1.4730876494023906, 1.4678552456839309, 1.4673904382470122, 1.4628950863213812, 1.4675298804780876, 1.472191235059761, 1.475723771580345, 1.4750332005312086, 1.4752523240371844, 1.4752656042496681, 1.4728021248339973, 1.4787981407702524, 1.4721845949535193, 1.4725564409030545, 1.4727490039840636, 1.4776427622841966, 1.468140770252324, 1.4582005312084994, 1.460843293492696, 1.4670584329349268, 1.4739508632138116, 1.4656706507304116, 1.4594023904382472, 1.4688512616201859, 1.4745949535192566, 1.4713147410358567, 1.4691567065073041, 1.4782403718459496, 1.475019920318725, 1.4665869853917664, 1.4668990703851261, 1.4718857901726428, 1.480338645418327, 1.4756972111553786, 1.4830278884462151, 1.4749468791500666, 1.4766733067729083, 1.4716467463479417, 1.4698074369189909, 1.4711553784860558, 1.4697410358565737, 1.4668193891102261, 1.4666467463479416, 1.4820119521912352, 1.472848605577689, 1.4700863213811421, 1.4694687915006641, 1.4693227091633467, 1.4723107569721114, 1.4716467463479415, 1.4725365205843295, 1.4714940239043823, 1.4695418326693226, 1.4640106241699868, 1.462078353253652, 1.4654847277556442, 1.4768857901726429, 1.4804980079681276, 1.4782005312084991, 1.4691102257636122, 1.475424966799469, 1.4802921646746345, 1.4690903054448872, 1.4705245683930943, 1.4755444887118194, 1.475219123505976, 1.4795152722443559, 1.4875298804780877, 1.4857636122177957, 1.4807835325365206, 1.4878087649402392, 1.4821713147410358, 1.4794754316069059, 1.481706507304117, 1.481440903054449, 1.4691301460823374, 1.4749667994687916, 1.4719853917662684, 1.470026560424967, 1.4562549800796813, 1.4722908366533862, 1.4680610889774237, 1.464355909694555, 1.4666865869853918, 1.4560823373173972, 1.4522908366533867, 1.4551726427622842, 1.453778220451527, 1.4668725099601596, 1.455179282868526, 1.4568193891102257, 1.4527091633466136, 1.455551128818061, 1.4615405046480745, 1.4612749003984062, 1.4676560424966802, 1.458605577689243, 1.4561354581673307, 1.4606573705179282, 1.4556241699867198, 1.4558565737051792, 1.4638844621513942, 1.4666865869853918, 1.4650398406374503, 1.4700597609561754, 1.4749867197875164, 1.4751128818061088, 1.4789973439575035, 1.4798671978751663, 1.4772841965471448, 1.4748937583001327, 1.4822244355909695, 1.4858764940239046, 1.483260292164675, 1.4758831341301462, 1.4888180610889774, 1.4863678618857903, 1.489575033200531, 1.4899003984063746, 1.4894953519256309, 1.4929747675962817, 1.4960956175298803, 1.4952191235059762, 1.495597609561753, 1.4930677290836656, 1.4941434262948208, 1.4889508632138115, 1.4795152722443559, 1.4929083665338645, 1.4923572377158034, 1.5010756972111554, 1.50128818061089, 1.4969721115537848, 1.4952855245683934, 1.4902124833997343, 1.4888379814077026, 1.4920916334661354, 1.49097609561753, 1.4885524568393094, 1.486726427622842, 1.4908565737051795, 1.4843293492695884, 1.4839907038512614, 1.482018592297477, 1.486281540504648, 1.4892563081009296, 1.4869588313413014, 1.493778220451527, 1.491334661354582, 1.4958565737051794, 1.498452855245684, 1.491460823373174, 1.4916201859229747, 1.4945484727755645, 1.489342629482072, 1.4797011952191235, 1.4841168658698538, 1.4862284196547144, 1.4937715803452856, 1.4908499335989378, 1.489555112881806, 1.4911620185922976, 1.487715803452855, 1.4812483399734397, 1.4821513944223106, 1.475849933598938, 1.4744754316069058, 1.48027224435591, 1.4752656042496681, 1.4794023904382472, 1.4789309428950865, 1.474893758300133, 1.4733266932270916, 1.4822045152722445, 1.4712151394422313, 1.4723041168658701, 1.4667065073041168, 1.4655909694555114, 1.4614541832669323, 1.4678884462151394, 1.4631341301460823, 1.4716733067729086, 1.4632470119521914, 1.4620982735723773, 1.4680942895086322, 1.4655909694555116, 1.458247011952191, 1.4611620185922976, 1.462144754316069, 1.451593625498008, 1.4530478087649403, 1.4535524568393092, 1.4565073041168661, 1.4594754316069056, 1.4577091633466135, 1.4576029216467463, 1.4472576361221778, 1.4514940239043825, 1.4601859229747676, 1.4601859229747676, 1.4599070385126163, 1.4481075697211157, 1.4509893758300132, 1.4541301460823373, 1.4503585657370517, 1.4387981407702524, 1.440398406374502, 1.4485989375830015, 1.4564276228419655, 1.4478950863213809, 1.4503253652058432, 1.452808764940239, 1.4506839309428952, 1.4428220451527223, 1.4504780876494026, 1.4514209827357238, 1.4502456839309428, 1.451414342629482, 1.4473837981407702, 1.453074369189907, 1.4488247011952191, 1.450922974767596, 1.4576626826029218, 1.4523638778220451, 1.4459362549800794, 1.4540836653386455, 1.4535989375830012, 1.451905710491368, 1.4521181938911023, 1.4505179282868526, 1.4550066401062418, 1.4542762284196546, 1.459409030544489, 1.4592828685258965, 1.4628751660026562, 1.465378486055777, 1.4606772908366534, 1.4542430278884462, 1.4536387782204516, 1.4599269588313413, 1.4671978751660026, 1.4659096945551129, 1.4625298804780877, 1.4636653386454186, 1.4667529880478087, 1.4659495351925633, 1.4669389110225766, 1.4639442231075697, 1.4589243027888448, 1.458339973439575, 1.4678419654714476, 1.4689707835325367, 1.467941567065073, 1.466467463479416, 1.4696746347941567, 1.4603851261620187, 1.468120849933599, 1.4684196547144757, 1.4736586985391766, 1.4718260292164678, 1.4603652058432934, 1.4624236387782203, 1.4633333333333334, 1.4644621513944225, 1.4615670650730412, 1.4631739707835325, 1.4635524568393095, 1.4638911022576364, 1.4693492695883135, 1.4651925630810092, 1.4713014608233734, 1.4681474103585657, 1.4762815405046483, 1.4695285524568393, 1.4738114209827358, 1.465484727755644, 1.4698339973439574, 1.4746082337317397, 1.472742363877822, 1.4681142098273572, 1.468386454183267, 1.4726693227091634, 1.470265604249668, 1.4692164674634796, 1.4699003984063745, 1.4801660026560424, 1.4758366533864542, 1.4725763612217795, 1.472410358565737, 1.4671779548472774, 1.4638379814077023, 1.4735059760956177, 1.4642363877822044, 1.46699203187251, 1.4687915006640107, 1.4776892430278883, 1.4767065073041168, 1.4750929614873838, 1.4772908366533868, 1.4650730411686588, 1.45371181938911, 1.463187250996016, 1.4643891102257638, 1.4633598937583003, 1.4706042496679947, 1.4722709163346615, 1.4663678618857903, 1.4732868525896412, 1.4747343957503318, 1.4765803452855246, 1.4714409030544489, 1.478120849933599, 1.470239043824701, 1.4758764940239044, 1.480265604249668, 1.4770385126162022, 1.4851261620185923, 1.475438247011952, 1.4746148738379814, 1.4752257636122177, 1.4774169986719787, 1.4762284196547144, 1.4777224435590968, 1.4743691899070386, 1.4792961487383798, 1.4806772908366532, 1.468891102257636, 1.469409030544489, 1.4835989375830012, 1.473871181938911, 1.474050464807437, 1.4773638778220453, 1.4798207171314741, 1.4756839309428953, 1.4701195219123506, 1.4718924302788843, 1.4717197875166004, 1.475152722443559, 1.4749468791500666, 1.4761022576361225, 1.4715670650730412, 1.465949535192563, 1.4817197875166002, 1.482808764940239, 1.4824634794156708, 1.4865471447543162, 1.4905843293492695, 1.4772974767596283, 1.4768459495351927, 1.4745086321381142, 1.4801128818061091, 1.4796945551128817, 1.4766467463479416, 1.4745551128818062, 1.4715869853917662, 1.4815869853917663, 1.4744953519256307, 1.4747144754316068, 1.4760026560424968, 1.4807835325365206, 1.4770517928286853, 1.4851726427622842, 1.4804714475431608, 1.4830478087649406, 1.4900199203187252, 1.4779747675962815, 1.4845883134130147, 1.4852390438247014, 1.4845750332005312, 1.4766467463479416, 1.4824634794156708, 1.4791766268260294, 1.478625498007968, 1.49, 1.4737782204515273, 1.478227091633466, 1.48531208499336, 1.4792762284196548, 1.4792563081009298, 1.4860225763612218, 1.4840836653386453, 1.4914010624169989, 1.4802523240371848, 1.4752124833997344, 1.4800066401062417, 1.4752124833997342, 1.4864741035856575, 1.4781872509960161, 1.4838579017264275, 1.4849269588313412, 1.4818791500664013, 1.475205843293493, 1.4895484727755643, 1.4876892430278883, 1.4938579017264277, 1.4857038512616203, 1.4832669322709164, 1.4839973439575034, 1.4831474103585656, 1.4863612217795485, 1.4945750332005312, 1.4874236387782205, 1.4927490039840638, 1.4794820717131476, 1.4782802124833998, 1.4865139442231077, 1.4890770252324037, 1.4911022576361221, 1.485225763612218, 1.4932669322709167, 1.4865869853917664, 1.4816666666666667, 1.4857171314741033, 1.4880013280212483, 1.4908698539176628, 1.487742363877822, 1.487788844621514, 1.4851925630810092, 1.4826029216467462, 1.488233731739708, 1.487416998671979, 1.486308100929615, 1.4918525896414343, 1.4874103585657372, 1.4860491367861886, 1.4949070385126164, 1.4924236387782206, 1.4900863213811422, 1.492523240371846, 1.4850332005312086, 1.4830411686586986, 1.4856308100929614, 1.4909163346613548, 1.4830677290836654, 1.4931274900398406, 1.4858233731739707, 1.4849269588313414, 1.4927091633466136, 1.480889774236388, 1.486215139442231, 1.4748406374501992, 1.4850398406374503, 1.4888446215139441, 1.484714475431607, 1.4822576361221778, 1.4931075697211154, 1.482257636122178, 1.4937450199203188, 1.4792828685258965, 1.4871181938911022, 1.4875431606905711, 1.4870916334661355, 1.4865405046480744, 1.4903718459495352, 1.4892828685258965, 1.4856839309428953, 1.488386454183267, 1.488120849933599, 1.4867662682602922, 1.4913877822045152, 1.4850265604249668, 1.4903917662682604, 1.48601593625498, 1.4857436918990705, 1.4874634794156705, 1.47800796812749, 1.4755909694555114, 1.4694156706507302, 1.4855179282868527, 1.4923970783532539, 1.4873505976095618, 1.4915338645418326, 1.483652058432935, 1.4748804780876494, 1.4872509960159364, 1.4802324037184595, 1.4809960159362552, 1.4830079681274901, 1.483897742363878, 1.487078353253652, 1.4897343957503317, 1.4900398406374502, 1.4929946879150067, 1.4789907038512617, 1.4859362549800799, 1.4903519256308102, 1.4922974767596282, 1.4851792828685257, 1.489621513944223, 1.4907370517928287, 1.4916865869853917, 1.4868260292164674, 1.487416998671979, 1.4883134130146083, 1.4889973439575033, 1.4847609561752988, 1.4867397078353255, 1.483260292164675, 1.4862549800796814, 1.494448871181939, 1.4942895086321382, 1.492742363877822, 1.4909827357237717, 1.4876162018592296, 1.4861553784860557, 1.4872642762284196, 1.4860557768924303, 1.482038512616202, 1.4804382470119521, 1.4836653386454182, 1.4832868525896414, 1.4943559096945553, 1.4858831341301462, 1.4833997343957506, 1.4860889774236388, 1.482815405046481, 1.4834926958831343, 1.4811288180610889, 1.4830610889774236, 1.4913479415670652, 1.484601593625498, 1.488691899070385, 1.4864475431606907, 1.4879216467463479, 1.482237715803453, 1.482855245683931, 1.4849933598937584, 1.482191235059761, 1.4809163346613547, 1.4859229747675964, 1.4807038512616204, 1.4818791500664013, 1.4838446215139443, 1.4847476759628158, 1.4832802124833995, 1.483140770252324, 1.482118193891102, 1.479136786188579, 1.4784395750332007, 1.4806772908366532, 1.4818592297476763, 1.480909694555113, 1.483964143426295, 1.4848605577689242])
def plot_zscan_normalized(z, values, xlabel="Posição Z (mm)"):
    z = np.array(z)
    values = np.array(values)
    
    n_points_base = 10 
    
    if len(values) > 2 * n_points_base:
        baseline_start = np.mean(values[:n_points_base])
        baseline_end = np.mean(values[-n_points_base:])
        baseline = (baseline_start + baseline_end) / 2
    else:
        baseline = np.mean(values)
        
    normalized_transmittance = values / baseline

    z_centro=(z[np.argmax(normalized_transmittance)]+z[np.argmin(normalized_transmittance)])/2
    plt.figure(figsize=(10, 6), dpi=100) # dpi ajusta a qualidade
    
    plt.plot(z-z_centro, normalized_transmittance, 
             marker='.',        
             markersize=1,
             linestyle='None',
             alpha=0.7,
             label='Dados Experimentais')


    plt.xlabel(xlabel, fontsize=12)
    plt.ylabel("Transmitância Normalizada (T)", fontsize=12)
    plt.legend()
    plt.grid(True, which='both', linestyle='--', alpha=0.5)
    
    plt.ylim(min(normalized_transmittance)*0.99, max(normalized_transmittance)*1.01)
    
    plt.tight_layout()
    plt.show()
from scipy.optimize import curve_fit

n_points_base = 100

if len(values) > 2 * n_points_base:
    baseline_start = np.mean(values[:n_points_base])
    baseline_end = np.mean(values[-n_points_base:])
    baseline = (baseline_start + baseline_end) / 2
else:
    baseline = np.mean(values)
    
values = values / baseline
z_centro=(position[np.argmax(values)]+position[np.argmin(values)])/2
position=position - z_centro
Z0_FIXO = 0.087 

WAVELENGTH = 795e-9
INTENSITY_I0 = 2.4e15
THICKNESS_L = 160e-6    
K = 2 * np.pi / WAVELENGTH

def zscan_model(z,d_phi0,m,off):
    # Centrar o eixo z
    x = (z) / (m*Z0_FIXO)
    
    transmittance = off - (4 * d_phi0 * x) / ((x**2 + 9) * (x**2 + 1))
    
    return transmittance


p0 = [0.5,10,0.5] 

popt, pcov = curve_fit(zscan_model, position, values, p0=p0)

d_phi0_fit = popt[0]
m_fit = popt[1]
off_fit = popt[2]

print("-" * 30)
print("RESULTADOS DO FIT:")
print(f"Delta Phi_0 encontrado: {d_phi0_fit:.5f}")
print(f"multiplicador Z_r: {m_fit:.5f}")
print(f"offset: {off_fit:.5f}")


n2_calc = -0.1042 / (K * INTENSITY_I0 * THICKNESS_L)
print(f"n2 Estimado: {n2_calc:.3e} m^2/W")
print("-" * 30)

z_smooth = np.linspace(min(position), max(position), 2000)
t_model = zscan_model(z_smooth, d_phi0_fit,m_fit,off_fit)

plt.figure(figsize=(10, 6))

# Dados Experimentais
plt.plot(position, values, '.', markersize=4, alpha=0.6, label='Closed Aperture Data')

# Curva de Ajuste (Fit)
plt.plot(z_smooth, t_model, 'r-', linewidth=2, label=f'Fitting Curve ($\Delta\Phi_0$={d_phi0_fit:.3f})')

# Linhas de referência
plt.axhline(1, color='gray', linestyle='--', linewidth=1)

plt.xlabel("Z (mm)")
plt.ylabel("Normalized Transmittance (T)")
plt.legend()
plt.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()